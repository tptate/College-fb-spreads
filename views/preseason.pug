extends layout

include mixins/_preseasonCard
include mixins/_preseasonTableRow

block content
  #main
  - let foundUser = false
  - const currentUser = user._id
  if preseasons
    each preseason in preseasons
      if preseason.author.equals(currentUser)
        - preseasonId = `/${preseason._id}`
        if !editPicks          
          a(href=`/weeks/preseason${preseasonId}/edit`)
            button.btn Click here to update picks
        - complete = 'yes'
  if(complete==='yes' && !editPicks)
    table.table
      thead
        td
        td Correct Pick
        each user in users
          if currentUser.equals(user._id)
            td #{user.name}
        each user in users
          if !currentUser.equals(user._id)
            td #{user.name}
      thead
        td
        td
        each user in users
          if currentUser.equals(user._id)
            each preseason in preseasons
              if preseason.author.equals(preseason.author)
                td= `total points: X`
        each user in users
          - foundUser = false
          if !currentUser.equals(user._id)
            each preseason in preseasons
              if preseason.author.equals(user._id)
                - foundUser = true
                td= `total points: X`
            if !foundUser
              td
      each preseason in preseasons
        +preseasonTableRow('ACC Atlantic', 'ACCa')
        +preseasonTableRow('ACC Coastal', 'ACCc')
        +preseasonTableRow('ACC', 'ACC')
        +preseasonTableRow('SEC East', 'SECe')
        +preseasonTableRow('SEC West', 'SECw')
        +preseasonTableRow('SEC', 'SEC')

  else  
    - let teams = []
    - let division = ""
    - let conference = ""
    h2= title
    p= preseasonId
    form.form-group(action=`/weeks/preseason${preseasonId || ''}` method="POST" class="card")
      - teams = [[1, 'Clemson'],[2, 'Syracuse'], [3, 'Florida State'], [4, 'NC State'], [5, 'Boston College'], [6, 'Wake Forest'],[7, 'Louisville']]
      - division = 'ACCa'
      - conference = 'ACC'  
      +preseasonCard(teams, division, conference)
      - teams = [[1, 'Virginia'],[2, 'Miami'], [3, 'Virginia Tech'], [4, 'Pittsburgh'], [5, 'Duke'], [6, 'North Carolina'],[7, 'Georgia Tech']]
      - division = 'ACCc'
      - conference = 'ACC'
      +preseasonCard(teams, division, conference)
      - teams = [[0, 'ACC Atlantic'], [0, 'ACC Coastal']];
      - division = 'ACC'
      - conference = 'ACC'
      +preseasonCard(teams, division, conference)
      - teams = [[1, 'Georgia'],[2, 'Florida'], [3, 'Missouri'], [4, 'South Carolina'], [5, 'Tennessee'], [6, 'Kentucky'],[7, 'Vanderbilt']]
      - division = 'SECe'
      - conference = 'SEC'  
      +preseasonCard(teams, division, conference)
      - teams = [[1, 'Alabama'],[2, 'LSU'], [3, 'Texas AM'], [4, 'Auburn'], [5, 'Mississippi St'], [6, 'Ole Miss'],[7, 'Arkansas']]
      - division = 'SECw'
      - conference = 'SEC'  
      +preseasonCard(teams, division, conference)
      - teams = [[0, 'SEC East'], [0, 'SEC West']];
      - division = 'SEC'
      - conference = 'SEC'
      +preseasonCard(teams, division, conference)

      input(type="submit" value="Submit Picks" class="btn form btn-secondary btn-lg")

  script(src="/javascripts/modules/preseason.js")
  script(src="/javascripts/modules/preseason-react.js" type = "text/babel")